<?php
include '../../includes/header.php';
$message = '';

if(isset($_SESSION['message'])) {
  $message = $_SESSION['message'];
  unset($_SESSION['message']);
}

if(isset($_GET['id']) && is_numeric($_GET['id'])) {
  $patientData = WSModel::get_ws_service(BASE_WS_URL.$ws_url['patientData'].$_GET['id']);
  
  if(isset($patientData->status) && $patientData->status == 1) {
    $patient = $patientData->response;

    if(strpos($patient->location, ',')) {
      $coordinates = explode(',', $patient->location);
      $latitude = $coordinates[0];
      $longitude = $coordinates[1];
    } else {
      $latitude = 13.0227200;
      $longitude = 80.2068040;
    }
  }
  //echo "<pre>"; print_r($patientData); exit;
  
  $patientInfoData = WSModel::get_ws_service(BASE_WS_URL.$ws_url['patientInfoData'].$_GET['id']);
  // echo "<pre>"; print_r($patientInfoData); exit;
  
  $patientProblemData = WSModel::get_ws_service(BASE_WS_URL.$ws_url['patientProblemData'].$_GET['id']);
  //echo "<pre>"; print_r($patientProblemData); exit;
  
  $patientHistoryData = WSModel::get_ws_service(BASE_WS_URL.$ws_url['patientHistoryData'].$_GET['id']);
  //echo "<pre>"; print_r($patientHistoryData); exit;
  
  $patientSurgeryData = WSModel::get_ws_service(BASE_WS_URL.$ws_url['patientSurgeryData'].$_GET['id']);
  //echo "<pre>"; print_r($patientSurgeryData); exit;
  
  $patientCircleData = WSModel::get_ws_service(BASE_WS_URL.$ws_url['patientCircleData'].$_GET['id']);
  //echo "<pre>"; print_r($patientCircleData); exit;
  
  $patientAllergyData = WSModel::get_ws_service(BASE_WS_URL.$ws_url['patientAllergyData'].$_GET['id']);
  //echo "<pre>"; print_r($patientAllergyData); exit;
  
  $patientMedicationData = WSModel::get_ws_service(BASE_WS_URL.$ws_url['patientMedicationData'].$_GET['id']);
  //echo "<pre>"; print_r($patientMedicationData); exit;
  $allUsers = WSModel::get_ws_service(BASE_WS_URL.$ws_url['allUsers']);
  
  $allRelations = WSModel::get_ws_service(BASE_WS_URL.$ws_url['allRelations']);
  
  }
?>
<?php include_once(BASE_DIR . 'includes/htmlheader.php');?>
	<style type="text/css">
		dt {
		float:left;
		width:25%;
		padding:5px;
		}
		dd {padding:5px;}
		.modal-body .form-horizontal .col-sm-2,
		.modal-body .form-horizontal .col-sm-10 {
		    width: 100%
		}
		.modal-body .form-horizontal .control-label {
		    text-align: left;
		}
		.modal-body .form-horizontal .col-sm-offset-2 {
		    margin-left: 15px;
		}
	</style>
    <div class="wrapper">
      <?php print mainHeader(); ?>      
      
      <?php print sideMenu(); ?>

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <h1>
            <?php echo $patient->firstname.' '.$patient->lastname; ?>
          </h1>
          <ol class="breadcrumb">
            <li><a href="<?php echo BASE_URL; ?>"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="<?php echo BASE_URL.'pages/patient/patients.html'; ?>"> Patients</a></li>
            <li class="active">Patient Information</li>
          </ol>
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="row">
            <div class="col-xs-12">
              <div class="box">
                <div class="box-header">
                  <?php echo $message; ?>
                </div><!-- /.box-header -->
                <div class="box-body">
                  <?php if(isset($patientData->response) && !empty($patientData->response)) { ?>
                      <div class="row">
                        <div class="col-md-8">
                          <div class="box box-solid">
                            <div class="box-bodys">
                              <div class="box-group" id="accordion">
                                  
                                <!-- Patient Personal Information -->
                                <div class="panel box box-primary">
                                  <div class="box-header with-border">
                                    <h4 class="box-title">
                                      <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                                        <i class="fa fa-info-circle"></i>Personal Information
                                      </a>
                                    </h4>
                                  </div>
                                  <div id="collapseOne" class="panel-collapse collapse in">
                                    <div class="box-body">
                                      <div class="container-fluid">
                                      <div class="row">
                                          <div class="col-md-6 col-xs-12">
											<dl>
												<dt>Full Name: </dt>
												<dd><?php echo $patient->firstname.' '.$patient->lastname;?></dd>
												<dt>Email: </dt>
												<dd><?php echo $patient->email;?></dd>
												<dt>DOB: </dt>
												<dd><?php echo date("Y-m-d", strtotime($patient->dob));?></dd>
												<dt>Gender: </dt>
												<dd><?php echo ($patient->gender=="M")?'Male':'Female';?></dd>
												<dt>IOT: </dt>
												<dd><?php echo $patient->iot;?></dd>
												<dt>Address: </dt>
												<dd><?php echo $patient->address;?></dd>
												<dt>Phone: </dt>
												<dd><?php echo $patient->phone;?></dd>
											</dl>
										  </div>
                                      </div>
                                      </div>
									  <!-- Patient info table start -->
										<div class="add-link" style="padding-bottom:15px;margin-bottom:22px;">
										<?php echo '<a class="btn btn-info pull-right" href="#" data-toggle="modal" data-target="#patientInfoForm" id="patientInfoFormLnk">ADD PATIENT INFO</a>'; ?>
										</div>
											<table id="patientInfo-list" class="table table-bordered table-striped">
											<thead>
											  <tr>
												<th>ID</th>
												<th>Date of Reading</th>
												<th>Height(cm)</th>
												<th>Weight(kg)</th>
												<th>Operations</th>
											  </tr>
											</thead>
											<tbody> 
											<?php 
											if(isset($patientInfoData->response) && !empty($patientInfoData->response)) { 										
												foreach ($patientInfoData->response as $patient_info) { 
													$pi_editLink = '<a href="#" class="editInfoLnk" id="' . $patient_info->id . '" data-toggle="modal" data-target="#patientInfoForm">EDIT</a>';
													$pi_deleteLink = '<a href="javascript:void(0);" class="pinfodel" data-id="'.BASE_URL.'pages/patient/wsClient.php#'.$patient_info->id.'" title="Are you sure you want to delete the Patient Info record?">DELETE</a>';
													$pi_operations = $pi_editLink.' | '.$pi_deleteLink;
											?>
													<tr id="pi-<?php echo $patient_info->id; ?>">
														<td><?php echo $patient_info->id; ?></td>
														<td id="pi1-<?php echo $patient_info->id; ?>"><?php echo date("Y-m-d h:i", strtotime($patient_info->recordedOn)); ?></td>
														<td id="pi2-<?php echo $patient_info->id; ?>"><?php echo $patient_info->height; ?></td>
														<td id="pi3-<?php echo $patient_info->id; ?>"><?php echo $patient_info->weight; ?></td>
														<td><?php echo $pi_operations; ?></td>
													</tr>
											<?php } 
											} 
											?>
											</tbody>
										</table>
										<?php if(!isset($patientInfoData->response) && empty($patientInfoData->response)) { ?>
											<p style="color:red;padding:5px;" id="norecInfo">No Records Found!	</p>
										<?php } ?>
										<!-- Patient info table end -->
										<!-- Modalbox start -->
										<div class="modal fade" id="patientInfoForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<!-- Modal Header -->
													<div class="modal-header">
														<button type="button" class="close" data-dismiss="modal">
															<span aria-hidden="true">&times;</span>
															<span class="sr-only">Close</span>
														</button>
														<h4 class="modal-title" id="myModalLabel">
															Patient Info
														</h4>
													</div>       
													<!-- Modal Body -->
													<div class="modal-body">
														<div id="messagebx"></div>
														<form role="form" name="patientInfoAddForm" id="patientInfoAddForm">
														<input type="hidden" name="patientInfoId" id="patientInfoId" />
														<input type="hidden" name="patientId" id="patientId" value="<?php echo $patient->id;?>" />
														<input type="hidden" name="wbUrl" id="wbUrl" value="<?php echo BASE_URL;?>pages/patient/wsClient.php" />
														<!--<div class="container">-->
														    <div class="form-group">
														       <!-- <div class='col-sm-6'>-->
														        	<label for="patientRDate">Reading Date</label>
														            <input type='text' class="form-control recordedOn" id='datetimepicker1' name="recordedOn" placeholder="Select Date" />
														        <!--</div>-->
														    </div>
														<!--</div>-->
														  <div class="form-group">
															<label for="patientHeight">Height(cm)</label>
															  <input type="text" maxlength="3" class="form-control" name="patientHeight" id="patientHeight" placeholder="Enter Height" required/>
														  </div>
														  <div class="form-group">
															<label for="patientWeight">Weight(kg)</label>
															  <input type="text" maxlength="3" class="form-control" id="patientWeight" name="patientWeight" placeholder="Enter Weight" required/>
														  </div>
														  <button type="button" class="btn btn-default"data-dismiss="modal"> Cancel </button>   
														  <button type="button" class="btn btn-primary" id="patientInfoSubmit">Submit</button>
														</form>
													</div>
													<!-- Modal Footer -->
													<div class="modal-footer">
													</div>
												</div>
											</div>
										</div>
										<!-- Modalbox end -->	
                                    </div>
                                  </div>
                                </div>
                                
                                <!-- Patient Problem Information -->
                                <div class="panel box box-primary">
                                  <div class="box-header with-border">
                                    <h4 class="box-title">
                                      <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
                                        <i class="fa fa-exclamation-circle"></i>Problems
                                      </a>
                                    </h4>
                                  </div>
                                  <div id="collapseTwo" class="panel-collapse collapse">
                                    <div class="box-body">	
										<div class="add-link" style="padding-bottom:15px;margin-bottom:22px;">
										<?php echo '<a class="btn btn-info pull-right" href="#" data-toggle="modal" data-target="#patientProblemForm" id="patientProblemFormLnk">ADD PATIENT PROBLEM</a>'; ?>
										</div>
											<table id="patientProblem-list" class="table table-bordered table-striped">
											<thead>
											  <tr>
												<th>ID</th>
												<th>Age of Occurence</th>
												<th>Chronicity</th>
												<th>Problem Details</th>
												<th>Operations</th>
											  </tr>
											</thead>
											<tbody>          
											<?php 
											if(isset($patientProblemData->response) && !empty($patientProblemData->response)) {
												foreach ($patientProblemData->response as $key => $prinfo) { 
													$pr_editLink = '<a href="#" class="editPrLnk" id="' . $prinfo->id . '" data-toggle="modal" data-target="#patientProblemForm">EDIT</a>';
													$pr_deleteLink = '<a href="javascript:void(0);" class="pPblmdel" data-id="'.BASE_URL.'pages/patient/wsClient.php#'.$prinfo->id.'" title="Are you sure you want to delete the Patient Problem Info record?">DELETE</a>';
													$pr_operations = $pr_editLink.' | '.$pr_deleteLink;
											?>
													<tr id="pp-<?php echo $prinfo->id; ?>">
														<td><?php echo $prinfo->id; ?></td>
														<td id="pp1-<?php echo $prinfo->id; ?>"><?php echo $prinfo->ageofoccurence; ?></td>
														<td id="pp2-<?php echo $prinfo->id; ?>"><?php echo $prinfo->chronicity; ?></td>
														<td id="pp3-<?php echo $prinfo->id; ?>"><?php echo $prinfo->problemdetails; ?></td>
														<td><?php echo $pr_operations; ?></td>
													</tr>
											<?php } 
											} 
											?>
											</tbody>
										</table>
										<?php if(!isset($patientProblemData->response) && empty($patientProblemData->response)) { ?>
											<p style="color:red;padding:5px;" id="noprobInfo">No Records Found!	</p>
										<?php } ?>
										<!-- Modalbox start -->
										<div class="modal fade" id="patientProblemForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<!-- Modal Header -->
													<div class="modal-header">
														<button type="button" class="close" data-dismiss="modal">
															<span aria-hidden="true">&times;</span>
															<span class="sr-only">Close</span>
														</button>
														<h4 class="modal-title" id="myModalLabel">
															Patient Problem
														</h4>
													</div>       
													<!-- Modal Body -->
													<div class="modal-body">
														<div id="messageprbx"></div>
														<form role="form" name="patientProblemAddForm" id="patientProblemAddForm">
														<input type="hidden" name="patientProblemId" id="patientProblemId" />
														<input type="hidden" name="patientId" id="patientId" value="<?php echo $patient->id;?>" />
														<input type="hidden" name="wbUrl" id="wbUrl" value="<?php echo BASE_URL;?>pages/patient/wsClient.php" />
														  <div class="form-group">
															<label for="problemOcAge">Age of Occurence</label>
															  <input type="text" maxlength="3" class="form-control" id="problemOcAge" name="problemOcAge" placeholder="Enter Age" required/>
														  </div>
														  <div class="form-group">
															<label for="problemChronicity">Chronicity</label>
															  <input type="text" class="form-control" id="problemChronicity" name="problemChronicity" placeholder="Enter Chronicity" required/>
														  </div>
														  <div class="form-group">
															<label for="problemDetails">Problem Details</label>
															  <input type="text" class="form-control" id="problemDetails" name="problemDetails" placeholder="Enter Problem Details" required/>
														  </div>
														  <button type="button" class="btn btn-default"data-dismiss="modal"> Cancel </button>   
														  <button type="button" class="btn btn-primary" id="patientProblemSubmit">Submit</button>
														</form>
													</div>
													<!-- Modal Footer -->
													<div class="modal-footer">
													</div>
												</div>
											</div>
										</div>
										<!-- Modalbox end -->	
										
										
                                    </div>
                                  </div>
                                </div>	
                                <!-- Patient History Information -->
                                <div class="panel box box-primary">
                                  <div class="box-header with-border">
                                    <h4 class="box-title">
                                      <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
                                        <i class="fa fa-history"></i>History
                                      </a>
                                    </h4>
                                  </div>
                                  <div id="collapseThree" class="panel-collapse collapse">
                                    <div class="box-body">
										<div class="add-link" style="padding-bottom:15px;margin-bottom:22px;">
										<?php echo '<a class="btn btn-info pull-right" href="#" data-toggle="modal" data-target="#patientHistoryForm" id="patientHistoryFormLnk">ADD PATIENT HISTORY</a>'; ?>
										</div>
										<table id="patientHistory-list" class="table table-bordered table-striped">
											<thead>
											  <tr>
												<th>ID</th>
												<th>Visited Date</th>
												<th>Details</th>
												<th>Operations</th>
											  </tr>
											</thead>
											<tbody>          
											<?php 
											if(isset($patientHistoryData->response) && !empty($patientHistoryData->response)) { 
												foreach ($patientHistoryData->response as $history_data) { 
													$ph_editLink = '<a href="javascript:void(0);" id="' . $history_data->id . '"  class="editPhLnk" data-toggle="modal" data-target="#patientHistoryForm">EDIT</a>';
													$ph_deleteLink = '<a href="javascript:void(0);" class="pHisdel" data-id="'.BASE_URL.'pages/patient/wsClient.php#'.$history_data->id.'" title="Are you sure you want to delete the Patient History record?">DELETE</a>';
													$ph_operations = $ph_editLink.' | '.$ph_deleteLink;
											?>
													<tr id="ph-<?php echo $history_data->id; ?>">
														<td><?php echo $history_data->id; ?></td>
														<td id="ph2-<?php echo $history_data->id; ?>"><?php echo $history_data->visitedDate; ?></td>
														<td id="ph1-<?php echo $history_data->id; ?>"><?php echo $history_data->details; ?></td>
														<td><?php echo $ph_operations; ?></td>
													</tr>
											<?php } 
											}
											?>
											</tbody>
										</table>
										<?php if(!isset($patientHistoryData->response) && empty($patientHistoryData->response)) {  ?>
											<p style="color:red;padding:5px;" id="nohisInfo">No Records Found!	</p>
										<?php } ?>
										<!-- Modalbox start -->
										<div class="modal fade" id="patientHistoryForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<!-- Modal Header -->
													<div class="modal-header">
														<button type="button" class="close" data-dismiss="modal">
															<span aria-hidden="true">&times;</span>
															<span class="sr-only">Close</span>
														</button>
														<h4 class="modal-title" id="myModalLabel">
															Patient History
														</h4>
													</div>       
													<!-- Modal Body -->
													<div class="modal-body">
														<div id="messagehsbx"></div>
														<form role="form" name="patientHistoryAddForm" id="patientHistoryAddForm">
														<input type="hidden" name="patientHistoryId" id="patientHistoryId" />
														<input type="hidden" name="patientId" id="patientId" value="<?php echo $patient->id;?>" />
														<input type="hidden" name="wbUrl" id="wbUrl" value="<?php echo BASE_URL;?>pages/patient/wsClient.php" />
														  <div class="form-group">
															<label for="historyDetails">History Details</label>
															  <input type="text" class="form-control" name="historyDetails" id="historyDetails" placeholder="Enter Details" required/>
														  </div>
														  <div class="form-group">
															<label for="visitedDate">Visited Date</label>
															  <input type="text" class="form-control" id="visitedDate" name="visitedDate" placeholder="Enter Visited Date" required/>
														  </div>
														  <button type="button" class="btn btn-default"data-dismiss="modal"> Cancel </button>   
														  <button type="button" class="btn btn-primary" id="patientHistorySubmit">Submit</button>
														</form>
													</div>
													<!-- Modal Footer -->
													<div class="modal-footer">
													</div>
												</div>
											</div>
										</div>
										<!-- Modalbox end -->
                                    </div>
                                  </div>
                                </div>
                                
                                <!-- Patient Allergy Information -->
                                <div class="panel box box-primary">
                                  <div class="box-header with-border">
                                    <h4 class="box-title">
                                      <a data-toggle="collapse" data-parent="#accordion" href="#collapseFour">
                                        <i class="fa fa-user-times"></i>Allergy
                                      </a>
                                    </h4>
                                  </div>
                                  <div id="collapseFour" class="panel-collapse collapse">
                                    <div class="box-body">
										<div class="add-link" style="padding-bottom:15px;margin-bottom:22px;">
										<?php echo '<a class="btn btn-info pull-right" href="#" data-toggle="modal" data-target="#patientAllergyForm" id="patientAlleryFormLnk">ADD PATIENT ALLERGY</a>'; ?>
										</div>
										<table id="patientAllergy-list" class="table table-bordered table-striped">
											<thead>
											  <tr>
												<th>ID</th>
												<th>Allergy</th>
												<th>Reaction</th>
												<th>Severity</th>
												<th>Source</th>
												<th>Operations</th>
											  </tr>
											</thead>
											<tbody>          
											<?php 
											if(isset($patientAllergyData->response) && !empty($patientAllergyData->response)) {
												foreach ($patientAllergyData->response as $allergy_data) { 
													$pa_editLink = '<a href="#" class="editPaLnk" id="' . $allergy_data->id . '" data-toggle="modal" data-target="#patientAllergyForm">EDIT</a>';
													$pa_deleteLink = '<a href="javascript:void(0);" data-id="'.$allergy_data->id.'" class="paldel" title="Are you sure you want to delete the Patient Allergy record?">DELETE</a>';
													$pa_operations = $pa_editLink.' | '.$pa_deleteLink;
											?>
													<tr id="pa-<?php echo $allergy_data->id; ?>">
														<td><?php echo $allergy_data->id; ?></td>
														<td id="pa1-<?php echo $allergy_data->id; ?>"><?php echo $allergy_data->allergy; ?></td>
														<td id="pa2-<?php echo $allergy_data->id; ?>"><?php echo $allergy_data->reaction; ?></td>
														<td id="pa3-<?php echo $allergy_data->id; ?>"><?php echo $allergy_data->severity; ?></td>
														<td id="pa4-<?php echo $allergy_data->id; ?>"><?php echo $allergy_data->source; ?></td>
														<td><?php echo $pa_operations; ?></td>
													</tr>
											<?php } 
											} 
											?>
											</tbody>
										</table>
										<?php if(!isset($patientAllergyData->response) && empty($patientAllergyData->response)) { ?>
											<p style="color:red;padding:5px;" id="noallergyInfo">No Records Found!	</p>
										<?php } ?>
										<!-- Modalbox start -->
										<div class="modal fade" id="patientAllergyForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<!-- Modal Header -->
													<div class="modal-header">
														<button type="button" class="close" data-dismiss="modal">
															<span aria-hidden="true">&times;</span>
															<span class="sr-only">Close</span>
														</button>
														<h4 class="modal-title" id="myModalLabel">
															Patient Allergy
														</h4>
													</div>       
													<!-- Modal Body -->
													<div class="modal-body">
														<div id="messagealbx"></div>
														<form role="form" name="patientAllergyAddForm" id="patientAllergyAddForm">
														<input type="hidden" name="patientAllergyId" id="patientAllergyId" />
														<input type="hidden" name="patientId" id="patientId" value="<?php echo $patient->id;?>" />
														<input type="hidden" name="wbUrl" id="wbUrl" value="<?php echo BASE_URL;?>pages/patient/wsClient.php" />
														  <div class="form-group">
															<label for="datePerformed">Allergy</label>
															  <input type="text" class="form-control" name="allergy" id="allergy" placeholder="Enter Allergy Detail" required/>
														  </div>
														  <div class="form-group">
															<label for="reaction">Reaction</label>
															  <input type="text" class="form-control" id="reaction" name="reaction" placeholder="Enter Reaction Details" required/>
														  </div>
														  <div class="form-group">
															<label for="severity">Severity</label>
															  <input type="text" class="form-control" id="severity" name="severity" placeholder="Enter Severity" required/>
														  </div>
														  <div class="form-group">
															<label for="source">Source</label>
															  <input type="text" class="form-control" id="source" name="source" placeholder="Enter Source" required/>
														  </div>
														  <button type="button" class="btn btn-default"data-dismiss="modal"> Cancel </button>   
														  <button type="button" class="btn btn-primary" id="patientAllergySubmit">Submit</button>
														</form>
													</div>
													<!-- Modal Footer -->
													<div class="modal-footer">
													</div>
												</div>
											</div>
										</div>
										<!-- Modalbox end -->
                                    </div>
                                  </div>
                                </div>
                                
                                <!-- Patient Surgery Information -->
                                <div class="panel box box-primary">
                                  <div class="box-header with-border">
                                    <h4 class="box-title">
                                      <a data-toggle="collapse" data-parent="#accordion" href="#collapseFive">
                                        <i class="fa fa-scissors"></i>Surgery Information
                                      </a>
                                    </h4>
                                  </div>
                                  <div id="collapseFive" class="panel-collapse collapse">
                                    <div class="box-body">
										<div class="add-link" style="padding-bottom:15px;margin-bottom:22px;">
										<?php echo '<a class="btn btn-info pull-right" href="#" data-toggle="modal" data-target="#patientSurgeryForm" id="patientSurgeryFormLnk">ADD PATIENT SURGERY</a>'; ?>
										</div>
										<table id="patientSurgery-list" class="table table-bordered table-striped">
											<thead>
											  <tr>
												<th>ID</th>
												<th>Surgery Date</th>
												<th>Surgery Details</th>
												<th>Operations</th>
											  </tr>
											</thead>
											<tbody>          
											<?php 
											if(isset($patientSurgeryData->response) && !empty($patientSurgeryData->response)) { 
												foreach ($patientSurgeryData->response as $surgery_data) { 
													$ps_editLink = '<a href="#" class="editPsLnk" id="' . $surgery_data->id . '" data-toggle="modal" data-target="#patientSurgeryForm">EDIT</a>';
													$ps_deleteLink = '<a href="javascript:void(0);" data-id="'.BASE_URL.'pages/patient/wsClient.php#'.$surgery_data->id.'" class="pSurdel" title="Are you sure you want to delete the Patient Surgery record?">DELETE</a>';
													$ps_operations = $ps_editLink.' | '.$ps_deleteLink;
											?>
													<tr id="ps-<?php echo $surgery_data->id; ?>">
														<td><?php echo $surgery_data->id; ?></td>
														<td id="ps1-<?php echo $surgery_data->id; ?>"><?php echo date("Y-m-d h:i A", strtotime($surgery_data->datePerformed)); ?></td>
														<td id="ps2-<?php echo $surgery_data->id; ?>"><?php echo $surgery_data->surgerydetails; ?></td>
														<td><?php echo $ps_operations; ?></td>
													</tr>
											<?php } 
											} 
											?>
											</tbody>
										</table>
										<?php if(!isset($patientSurgeryData->response) && empty($patientSurgeryData->response)) {  ?>
											<p style="color:red;padding:5px;" id="nosurInfo">No Records Found!	</p>
										<?php } ?>
										<!-- Modalbox start -->
										<div class="modal fade" id="patientSurgeryForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<!-- Modal Header -->
													<div class="modal-header">
														<button type="button" class="close" data-dismiss="modal">
															<span aria-hidden="true">&times;</span>
															<span class="sr-only">Close</span>
														</button>
														<h4 class="modal-title" id="myModalLabel">
															Patient Surgery
														</h4>
													</div>       
													<!-- Modal Body -->
													<div class="modal-body">
														<div id="messagepsbx"></div>
														<form role="form" name="patientSurgeryAddForm" id="patientSurgeryAddForm">
														<input type="hidden" name="patientSurgeryId" id="patientSurgeryId" />
														<input type="hidden" name="patientId" id="patientId" value="<?php echo $patient->id;?>" />
														<input type="hidden" name="wbUrl" id="wbUrl" value="<?php echo BASE_URL;?>pages/patient/wsClient.php" />
														  <div class="form-group">
															<label for="datePerformed">Surgery Date</label>
															  <input type="text" class="form-control" name="datePerformed" id="datePerformed" placeholder="Enter Surgery Date" required/>
														  </div>
														  <div class="form-group">
															<label for="surgerydetails">Surgery Details</label>
															  <input type="text" class="form-control" id="surgerydetails" name="surgerydetails" placeholder="Enter Surgery Details" required/>
														  </div>
														  <button type="button" class="btn btn-default"data-dismiss="modal"> Cancel </button>   
														  <button type="button" class="btn btn-primary" id="patientSurgerySubmit">Submit</button>
														</form>
													</div>
													<!-- Modal Footer -->
													<div class="modal-footer">
													</div>
												</div>
											</div>
										</div>
										<!-- Modalbox end -->
                                    </div>
                                  </div>
                                </div>
                                  
                                  <!-- Patient Medication Information -->
                                <div class="panel box box-primary">
                                  <div class="box-header with-border">
                                    <h4 class="box-title">
                                      <a data-toggle="collapse" data-parent="#accordion" href="#collapseSix">
                                        <i class="fa fa-medkit"></i>Medication
                                      </a>
                                    </h4>
                                  </div>
                                  <div id="collapseSix" class="panel-collapse collapse">
                                    <div class="box-body">
										<div class="add-link" style="padding-bottom:15px;margin-bottom:22px;">
										<?php echo '<a class="btn btn-info pull-right" href="#" data-toggle="modal" data-target="#patientMedicineForm" id="patientMedicineFormLnk">ADD PATIENT MEDICINE</a>'; ?>
										</div>
										<table id="patientMedicine-list" class="table table-bordered table-striped">
											<thead>
											  <tr>
												<th>ID</th>
												<th>Medicine</th>
												<th>Frequency</th>
												<th>Refills</th>
												<th>Route</th>
												<th>Operations</th>
											  </tr>
											</thead>
											<tbody>          
											<?php 
											if(isset($patientMedicationData->response) && !empty($patientMedicationData->response)) {
												foreach ($patientMedicationData->response as $med_data) { 
													$pm_editLink = '<a href="#" class="editPmLnk" id="' . $med_data->id . '" data-toggle="modal" data-target="#patientMedicineForm">EDIT</a>';
													$pm_deleteLink = '<a href="javascript:void(0);" data-id="'.BASE_URL.'pages/patient/wsClient.php#'.$med_data->id.'" class="pMedicinedel" title="Are you sure you want to delete the Patient Medicine record?">DELETE</a>';
													$pm_operations = $pm_editLink.' | '.$pm_deleteLink;
											?>
													<tr id="pm-<?php echo $med_data->id; ?>">
														<td><?php echo $med_data->id; ?></td>
														<td id="pm1-<?php echo $med_data->id; ?>"><?php echo $med_data->medicine; ?></td>
														<td id="pm2-<?php echo $med_data->id; ?>"><?php echo $med_data->frequency; ?></td>
														<td id="pm3-<?php echo $med_data->id; ?>"><?php echo $med_data->refills; ?></td>
														<td id="pm4-<?php echo $med_data->id; ?>"><?php echo $med_data->route; ?></td>
														<td><?php echo $pm_operations; ?></td>
													</tr>
											<?php } 
											}
											?>
										</tbody>
										</table>
										<?php if(!isset($patientMedicationData->response) && empty($patientMedicationData->response)) { ?>
											<p style="color:red;padding:5px;" id="nomedInfo">No Records Found!	</p>
										<?php } ?>
										<!-- Modalbox start -->
										<div class="modal fade" id="patientMedicineForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<!-- Modal Header -->
													<div class="modal-header">
														<button type="button" class="close" data-dismiss="modal">
															<span aria-hidden="true">&times;</span>
															<span class="sr-only">Close</span>
														</button>
														<h4 class="modal-title" id="myModalLabel">
															Patient Medication
														</h4>
													</div>       
													<!-- Modal Body -->
													<div class="modal-body">
														<div id="messagepmbx"></div>
														<form role="form" name="patientMedicineAddForm" id="patientMedicineAddForm">
														<input type="hidden" name="patientMedicineId" id="patientMedicineId" />
														<input type="hidden" name="patientId" id="patientId" value="<?php echo $patient->id;?>" />
														<input type="hidden" name="wbUrl" id="wbUrl" value="<?php echo BASE_URL;?>pages/patient/wsClient.php" />
														  <div class="form-group">
															<label for="medicine">Medicine</label>
															  <input type="text" class="form-control" name="medicine" id="medicine" placeholder="Enter Medicine" required/>
														  </div>
														  <div class="form-group">
															<label for="frequency">Frequency</label>
															  <input type="text" class="form-control" id="frequency" name="frequency" placeholder="Enter Frequency" required/>
														  </div>
														  <div class="form-group">
															<label for="refills">Refills</label>
															  <input type="text" class="form-control" id="refills" name="refills" placeholder="Enter Refills" required/>
														  </div>
														  <div class="form-group">
															<label for="route">Route</label>
															  <input type="text" class="form-control" id="route" name="route" placeholder="Enter Route" required/>
														  </div>
														  <button type="button" class="btn btn-default"data-dismiss="modal"> Cancel </button>   
														  <button type="button" class="btn btn-primary" id="patientMedicineSubmit">Submit</button>
														</form>
													</div>
													<!-- Modal Footer -->
													<div class="modal-footer">
													</div>
												</div>
											</div>
										</div>
										<!-- Modalbox end -->
                                    </div>
                                  </div>
                                </div>
                                
                                <!-- Patient Circle Information -->
                                <div class="panel box box-primary">
                                  <div class="box-header with-border">
                                    <h4 class="box-title">
                                      <a data-toggle="collapse" data-parent="#accordion" href="#collapseSeven">
                                        <i class="fa fa-users"></i>Patient Circles
                                      </a>
                                    </h4>
                                  </div>
                                  <div id="collapseSeven" class="panel-collapse collapse">
                                    <div class="box-body">
										<div class="add-link" style="padding-bottom:15px;margin-bottom:22px;">
										<?php echo '<a class="btn btn-info pull-right" href="'.BASE_URL.'pages/patient/addPatientCircle.html?pid='.$patient->id	.'" data-toggle="modal" data-target="#patientCircleForm">ADD PATIENT CIRCLE</a>'; ?>
										</div>
										<?php if(isset($patientCircleData->response) && !empty($patientCircleData->response)) { ?>
											<table id="patientCircle-list" class="table table-bordered table-striped">
											<thead>
											  <tr>
												<th>ID</th>
												<th>Full Name</th>
												<th>Gender</th>
												<th>DOB</th>
												<th>Email</th>
												<th>Phone</th>
												<th>Operations</th>
											  </tr>
											</thead>
											<tbody>          
											<?php foreach ($patientCircleData->response as $circle_data) { ?>
											<?php
											    $pc_editLink = '<a href="#" class="editPcLnk" id="' . $circle_data->id . '" data-toggle="modal" data-target="#patientCircleForm">EDIT</a>';
												$pc_deleteLink = '<a href="javascript:void(0);" class="pCircledel" data-id="'.BASE_URL.'pages/patient/wsClient.php#'.$circle_data->id.'" title="Are you sure you want to delete the Patient Circle record?">DELETE</a>';
												$pc_operations = $pc_editLink.' | '.$pc_deleteLink;
											?>
											  <tr id="pc-<?php echo $circle_data->id; ?>">
												<td id='pc1-<?php echo $circle_data->id; ?>'><?php echo $circle_data->id; ?></td>
												<td id='pc2-<?php echo $circle_data->id; ?>'><?php echo $circle_data->title . ". " . $circle_data->firstname . " " . $circle_data->lastname; ?></td>
												<td id='pc3-<?php echo $circle_data->id; ?>'>
												<?php if($circle_data->gender == "M") { echo 'Male'; } else if($circle_data->gender == "F") { echo 'Female';}else if($circle_data->gender == "T") { echo 'Transgender';}?></td>
												<td id='pc4-<?php echo $circle_data->id; ?>'><?php echo date("Y-m-d", strtotime($circle_data->dob)); ?></td>
												<td id='pc5-<?php echo $circle_data->id; ?>'><?php echo $circle_data->email; ?></td>
												<td id='pc6-<?php echo $circle_data->id; ?>'><?php echo $circle_data->phone; ?></td>
												<td><?php echo $pc_operations; ?></td>
											  </tr>
											<?php } ?>
										</tbody>
										</table>
										<?php } else { ?>
											<p>No Records Found!	</p>
										<?php } ?>
										<!-- Modalbox start -->
										<div class="modal fade" id="patientCircleForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
											<!-- Modal Body -->
											<div class="modal-dialog">
												<div class="modal-content">
													<!-- Modal Header -->
													<div class="modal-header">
														<button type="button" class="close" data-dismiss="modal">
															<span aria-hidden="true">&times;</span>
															<span class="sr-only">Close</span>
														</button>
														<h4 class="modal-title" id="myModalLabel">
															Patient Circle
														</h4>
													</div>       
													<!-- Modal Body -->
													<div class="modal-body">
														<div id="messagepmbx"></div>
														<form role="form" name="patientCircleAddForm" id="patientCircleAddForm">
														<input type="hidden" name="patientCircleId" id="patientCircleId" />
														<input type="hidden" name="patientId" id="patientId" value="<?php echo $patient->id;?>" />
														<input type="hidden" name="wbUrl" id="wbUrl" value="<?php echo BASE_URL;?>pages/patient/wsClient.php" />
														  <div class="form-group">
															<label for="route">User</label>
															   <select class="form-control" id="user" name="user" required>
															   		<option value="">--Select--</option>
															   	    <?php  foreach ($allUsers->response as $all_users) { 
															   	    	echo '<option value="'.$all_users->id.'">'.$all_users->firstName.'</option>';
															   	    }?>
 																	
  																</select> 
														  </div>
														  <div class="form-group">
															<!--<label for="dob">DOB</label>-->
															  <input type="hidden" class="form-control" id="dob" name="dob" placeholder="Enter DOB" />
														  </div>
														  <div class="form-group">
															<!--<label for="email">Email</label>-->
															  <input type="hidden" class="form-control" id="email" name="email" placeholder="Enter Email" />
														  </div>
														  <div class="form-group">
															<!--<label for="firstname">Firstname</label>-->
															  <input type="hidden" class="form-control" id="firstname" name="firstname" placeholder="Enter Firstname" />
														  </div>
														  <div class="form-group">
															<!--<label for="firstname">Gender</label>-->
															
															  <input type="hidden" class="form-control" id="gender" name="gender" placeholder="Enter Gender" />
														  </div>
														  <!--<div class="form-group">
															  <label for="userInputGender">Gender</label>
															  <div class="radio">
																<label>
																  <input tabindex="13" name="optionsGender" id="optionsRadios1" value="M" checked="" type="radio">
																  Male
																</label>
															  </div>
															  <div class="radio">
																<label>
																  <input tabindex="14" name="optionsGender" id="optionsRadios2" value="F" type="radio">
																  Female
																</label>
															  </div>
															  <div class="radio">
																<label>
																  <input tabindex="15" name="optionsGender" id="optionsRadios3" value="T" type="radio">
																  Transgender
																</label>
															  </div>
														  </div>-->
														  <div class="form-group">
															<!--<label for="lastname">Lastname</label>-->
															  <input type="hidden" class="form-control" id="lastname" name="lastname" placeholder="Enter Lastname"/>
														  </div>
														  <div class="form-group">
															<!--<label for="phone">Phone</label>-->
															  <input type="hidden" class="form-control" id="phone" name="phone" placeholder="Enter Phone"/>
														  </div>
														  <div class="form-group">
															<!--<label for="title">Title</label>-->
															  <input type="hidden" class="form-control" id="title" name="title" placeholder="Enter Title" />
														  </div>
														  <div id="userListTable">
														  </div>
														  <div class="form-group">
															<label for="relation">Relation</label>
															  <select class="form-control" id="relation" name="relation" required>
															   		<option value="">--Select--</option>
															   	    <?php  foreach ($allRelations->response as $relations) { 
															   	    	echo '<option value="'.$relations->id.'">'.$relations->relationType.'</option>';
															   	    }?>
 																	
  																</select> 
														  </div>
														  <button type="button" class="btn btn-default"data-dismiss="modal"> Cancel </button>   
														  <button type="button" class="btn btn-primary" id="patientCircleSubmit">Submit</button>
														</form>
													</div>
													<!-- Modal Footer -->
													<div class="modal-footer">
													</div>
												</div>
											</div>
													<!-- Modal Footer -->
													<!--<div class="modal-footer"
														<button type="button" class="btn btn-default"data-dismiss="modal"> Close </button>
														<button type="button" class="btn btn-primary"> Save changes </button>
													</div>-->
												</div>
											</div>
										</div>
										<!-- Modalbox start -->		
                                    </div>
                                  </div>
                                </div>
                                  
                                  
                              </div>
                            <!--</div><!-- /.box-body -->
                          <!--</div><!-- /.box -->
                        </div><!-- /.col -->
                          
                        <div class="col-md-4">
                          <div class="box box-solid">
                            <div class="box-header with-border">
                              <h3 class="box-title">Location</h3>
                            </div><!-- /.box-header -->
                            <div class="box-bodys">
                              <div id="us3" style="width: 100%; height: 250px;"></div>
                            </div><!-- /.box-body -->
                          </div><!-- /.box -->
                        </div><!-- /.col -->
                      </div><!-- /.row -->
                  <?php } else { ?>
                    <p>No records found or the server is not reachable now. Please login again.</p>
                  <?php } ?>
                </div><!-- /.box-body -->
              </div><!-- /.box -->
            </div><!-- /.col -->
          </div><!-- /.row -->
        </section><!-- /.content -->
      </div><!-- /.content-wrapper -->
      <!-- Add the sidebar's background. This div must be placed
           immediately after the control sidebar -->
      <div class="control-sidebar-bg"></div>
    </div><!-- ./wrapper -->
	<?php include_once(BASE_DIR . 'includes/htmlfooter.php');?>
    <!-- page script -->
    <script>
      $(function () {
			$('#us3').locationpicker({
			  location: {latitude: <?php echo $latitude; ?>, longitude: <?php echo $longitude; ?>},
			  radius: 25,
			  scrollwheel: false
			});
			$('#datetimepicker1, #visitedDate, #datePerformed, #dob').datetimepicker({
				format: 'Y-m-d H:i',
				step: 1,
				maxDate: 0
			});
			
      });
 </script>

